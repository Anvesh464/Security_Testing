# Introduction

The **Oversecured Vulnerable Android Application (OVAA)** is a project designed to demonstrate common security vulnerabilities in Android applications. It provides an opportunity to explore and understand various weaknesses, from file theft to cryptographic flaws, unprotected activities, and insecure services.

In this post, we will cover a continuation of vulnerabilities found in OVAA, following on from the first blog post. We will discuss five vulnerabilities, their exploitation, and how to create exploit applications for each.

---

### Table of Contents:

- [File Theft Via Picker](#1-file-theft-via-picker)
- [Unprotected Activity Launch](#2-unprotected-activity-launch)
- [Weak Crypto](#3-weak-crypto)
- [Insecure Logger Service](#4-insecure-logger-service)
- [Hardcoded Credentials](#5-hardcoded-credentials)

---

### 1. File Theft Via Picker

In the **File Theft Via Picker** vulnerability, the OVAA app allows users to select images using an app chooser (via a **pickerIntent**). However, it does not adequately secure the chosen files, which can lead to unauthorized access.

#### Understanding the Flow:

- After selecting a file, the app uses **startActivityForResult()** to retrieve the selected file's URI and passes it to a method called **FileUtils.copyToCache**.
- The selected image is copied to a cache directory at `/storage/emulated/0/Android/data/oversecured.ovaa/cache`.
- This cache file can then be accessed by an attacker.

#### Exploit Application:

- Create an app that returns the **URI** of a file (e.g., `login_data.xml`) when selected.
- The exploit app would be set to handle the intent with the **image/* MIME type**.
- Once the attacker selects the exploit app, the target app stores the file in the cache folder.

**Result**: By navigating to the cache folder, the attacker can access sensitive files, such as `login_data.xml`.

---

### 2. Unprotected Activity Launch

In this vulnerability, OVAA sends **base64-encoded credentials** to a website. However, the activity handling this is unprotected and vulnerable to interception.

#### Understanding the Flow:

- When the **Unprotected Activity Launch** button is clicked, the app retrieves login data, encrypts it, and sends it as a **base64-encoded token**.
- The app then starts a web view activity to handle the token transmission.
- If an attacker can resolve the intent associated with the web view, they can intercept the token.

#### Exploit Application:

- Create an activity that resolves the intent with the action **oversecured.ovaa.action.WEBVIEW**.
- The exploit app can log the intercepted **base64-encoded token** in its logs.
- By running **pidcat** to view logs, the attacker can capture the token.

**Result**: The attacker obtains the base64 token, which can later be decoded to retrieve the login credentials.

---

### 3. Weak Crypto

OVAA uses weak cryptography for encrypting sensitive data, such as credentials. The encryption method can be easily bypassed due to the hardcoded encryption key.

#### Understanding the Cryptographic Algorithm:

- The app uses **AES encryption** in a vulnerable manner, with the **secret key** hardcoded in the source code.
- By decompiling the APK, the attacker can easily find the key and use it to decrypt the data.

#### Exploit Application:

- Extract the secret key from the decompiled code and use it in the exploit app to decrypt the token.
- After retrieving the encrypted token from the vulnerable app, decrypt it using **AES decryption**.
- The decrypted credentials will be logged in the exploit app.

**Result**: The attacker decrypts the credentials and gains unauthorized access to sensitive information.

---

### 4. Insecure Logger Service

The OVAA app has an insecure logging service that is **exported**. This allows other apps to access and dump the applicationâ€™s logs, which could contain sensitive information.

#### Understanding the Flow:

- The insecure service is triggered by an intent with action **oversecured.ovaa.action.DUMP**.
- The app will dump logs into a file, which can be accessed by any app that calls the service.

#### Exploit Application:

- The exploit app creates an intent with the action **oversecured.ovaa.action.DUMP** and specifies a file to dump the logs.
- By starting the **InsecureLoggerService** using **startService()**, the exploit app retrieves the logs containing sensitive data, such as credentials.

**Result**: Sensitive data is dumped into a file, such as `logs.txt`, which the attacker can read.

---

### 5. Hardcoded Credentials

OVAA contains hardcoded credentials stored in the **strings.xml** file. These credentials can be easily extracted from the decompiled APK.

#### Exploit Application:

- Use a decompiler (e.g., **jadx-gui**) to extract the **strings.xml** file from the APK.
- This file contains sensitive information like hardcoded credentials.

**Result**: The attacker can directly read the stored credentials from the **strings.xml** file, granting unauthorized access.

---

### Conclusion

This post continues the discussion of vulnerabilities in the OVAA (Oversecured Vulnerable Android App). Each of these vulnerabilities provides a valuable learning opportunity for understanding how security flaws in Android applications can be exploited. The exploit applications created for each vulnerability demonstrate how attackers might gain unauthorized access to sensitive data or functionality.

By learning how to identify and exploit these vulnerabilities, developers and security professionals can better protect their own apps from similar threats.
